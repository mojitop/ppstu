<layout name="common" />

<!-- 列表 -->
<div class="list-div" id="listDiv">
    <form method="post" action="__SELF__">
	<table cellpadding="3" cellspacing="1">
                <tr>
                    <?php foreach($_ga_data as $k =>$v):
                      $cols = count($_ga_data)+2;
                      $val_times = 0;
                    ?>
                      <th><?php echo $k;?></th>
                    <?php endforeach;?>
                    <th width="200" >库存量</th>
                    <th width="100">操作</th>
                </tr>
                
                <?php if($gn_data):?>
                
		<?php foreach($gn_data as $gnk => $gnv):
                    $ga_id=explode(',',$gnv['goods_attr_id']);
                ?>       
		<tr class="tron" >                   
                 <?php foreach ($_ga_data as $k => $v): ?>     
                        <td align='center'> 
                           <select name="goods_attr_id[]">
                            <?php foreach($v as $k1 => $v1):
                               if( in_array($v1['id'],$ga_id ) ){
                                  $sel = 'selected="selected"';
                               }else{
                                 $sel='';
                               }
                            ?>
                            <option <?php echo $sel;?> value="<?php echo $v1['id'];?>"><?php echo $v1['attr_value'];?></option>
                            <?php endforeach;?>
                            </select>
                       </td>
                <?php endforeach; ?>     
                <td align='center'><input type='text' name='goods_number[]' value="<?php echo$gnv['goods_number'];?>" title='请输入库存数量' /></td>
                <?php if($val_times ==0 ){
                     echo "<td align='center'><input class='set_val'type='button' onclick='addNewTr(event)' value='增加' /></td>";
                     $val_times++;
                 }else{               
                     echo "<td align='center'><input class='set_val'type='button' onclick='addNewTr(event)' value='删除' /></td>";
                      $val_times++;
                }?>
	        </tr>
                <?php endforeach;?>
                <?php else: ?>
                <tr><p><?php echo '天啦！！还没有设置商品库存量！！先去设置好商品属性再来吧！！~~~~(>_<)~~~~';?></p></tr>
		<tr class="tron" >                   
                 <?php foreach ($_ga_data as $k => $v): ?>     
                        <td align='center'> 
                           <select name="goods_attr_id[]">
                            <?php foreach($v as $k1 => $v1):?>
                                   <option <?php echo $sel;?> value="<?php echo $v1['id'];?>"> <?php echo $v1['attr_value'];?> </option>
                            <?php endforeach;?>
                            </select>
                       </td>
                <?php endforeach; ?>     
                <td align='center'><input type='text' name='goods_number[]' value="" title='请输入库存数量' /></td>

                    <td align='center'><input class='set_val'type='button' onclick='addNewTr(event)' value='增加' /></td>

	        </tr>
                <?php endif; ?>
                
                <tr id='submitTr'><td colspan="<?php echo $cols;?>"> <input type="submit" value="提交"/></td></tr>
	</table>
    </form>
</div>

<script type='text/javascript'>
   function addNewTr(evt){ 
      if( $(evt.target).val() == "增加" ){
          
           var tr =$(evt.target).parent().parent();
           var newTr = tr.clone(true);
           newTr.find('.set_val').val("删除");
           $('#submitTr').before(newTr);         
        }else{
            $(evt.target).parent().parent().remove();
        }

   }
</script>
<script type="text/javascript" src="__PUBLIC__/umeditor1_2_2-utf8-php/third-party/jquery.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Admin/Js/tron.js"></script>